//main function to be called on submit
function processData(){if(!navigator.onLine){var a=document.querySelector("#product_name"),b=a.value;saveDataLocally(b),a.value=""}}function sendDataToServer(a){var b={commit:"Create Product",product:{name:a}};$.ajax({type:"POST",url:"/products",data:b,dataType:"html"})}function saveDataLocally(a){var b=new Date;b.getTime();try{localStorage.setItem(b,a),alert("Saved locally: "+a+"")}catch(c){c==QUOTA_EXCEEDED_ERR&&console.log("Limit has been exceeded!")}var d=window.localStorage.length;document.querySelector("#local-count").innerHTML=d}function sendLocalDataToServer(){var a=document.querySelector("#status");a.className="online",a.innerHTML="Online";var b=0,c="";while(b<=window.localStorage.length-1)c=localStorage.key(b),c?(sendDataToServer(localStorage.getItem(c)),window.localStorage.removeItem(c)):b++;document.querySelector("#local-count").innerHTML=window.localStorage.length}function notifyUserIsOffline(){var a=document.querySelector("#status");a.className="offline",a.innerHTML="Offline"}function loaded(){var a=window.localStorage.length;document.querySelector("#local-count").innerHTML=a;if(navigator.onLine){var b=document.querySelector("#status");b.className="online",b.innerHTML="Online",a!==0&&sendLocalDataToServer()}window.addEventListener("online",sendLocalDataToServer,!1),window.addEventListener("offline",notifyUserIsOffline,!1),document.querySelector('[type="submit"]').addEventListener("click",processData,!1)}window.addEventListener("load",loaded,!0);